<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalkulator Resistor</title>
<link rel="manifest" href="manifest.webmanifest">
  <style>
  body {font-family: Arial, sans-serif; background:#0f172a; color:#f1f5f9; padding:20px}
  h1 {color:#38bdf8; font-size:22px}
  .card {background:#1e293b; padding:16px; border-radius:12px; margin-bottom:16px}
  label {display:block; margin:6px 0}
  select, input {padding:6px; border-radius:6px; border:1px solid #475569; margin:4px 0; background:#0f172a; color:#f1f5f9}
  button {padding:8px 14px; margin-top:8px; border:none; border-radius:8px; background:#38bdf8; color:#0f172a; font-weight:600; cursor:pointer}
  .result {margin-top:12px; padding:10px; background:#0f172a; border-radius:8px;}
</style>
</head>
<footer id="donateFooter">
  <span>Gratis untuk semua</span>
  <a href="https://saweria.co/valitio" target="_blank" rel="noopener noreferrer">
    üíù Dukung via Saweria
  </a>
</footer>

<style>
  #donateFooter {
    position: fixed;
    bottom: 0; left: 0;
    width: 100%;
    background: var(--card);
    border-top: 1px solid var(--border);
    color: var(--text);
    font-size: 0.9rem;
    text-align: center;
    padding: 10px;
    display: flex;
    justify-content: center;
    gap: 10px;
    z-index: 999;
  }
  #donateFooter a {
    color: #f97316;
    font-weight: 600;
    text-decoration: none;
  }
  #donateFooter a:hover {
    text-decoration: underline;
  }
</style>

<body>
<h1>Kalkulator Resistor</h1>

<div class="card">
  <h2>Resistor Karbon (Warna Gelang)</h2>
  <label>Jumlah gelang:
    <select id="gelangCount">
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
    </select>
  </label>
  <div id="warnaInputs"></div>
  <button onclick="hitungResistorWarna()">Hitung</button>
  <div class="result" id="hasilWarna"></div>
</div>

<div class="card">
  <h2>Resistor SMD (Kode)</h2>
  <label>Kode Resistor:
    <input type="text" id="kodeSMD" placeholder="contoh: 103, 472, 4R7">
  </label>
  <button onclick="hitungResistorSMD()">Hitung</button>
  <div class="result" id="hasilSMD"></div>
</div>

<script>
const warnaMap = {
  hitam:{val:0, mult:1, tol:null},
  coklat:{val:1, mult:10, tol:1},
  merah:{val:2, mult:100, tol:2},
  oranye:{val:3, mult:1000, tol:null},
  kuning:{val:4, mult:10000, tol:null},
  hijau:{val:5, mult:100000, tol:0.5},
  biru:{val:6, mult:1000000, tol:0.25},
  ungu:{val:7, mult:10000000, tol:0.1},
  abu:{val:8, mult:100000000, tol:0.05},
  putih:{val:9, mult:1000000000, tol:null},
  emas:{val:null, mult:0.1, tol:5},
  perak:{val:null, mult:0.01, tol:10},
  none:{val:null, mult:null, tol:20}
};

const warnaList = Object.keys(warnaMap);

function buatInputWarna(jumlah){
  let html="";
  for(let i=1;i<=jumlah;i++){
    html+=`<label>Gelang ${i}: <select id="gelang${i}">`;
    for(let w of warnaList){
      html+=`<option value="${w}">${w}</option>`;
    }
    html+="</select></label>";
  }
  document.getElementById('warnaInputs').innerHTML=html;
}

// inisialisasi default 4 gelang
buatInputWarna(4);

document.getElementById('gelangCount').addEventListener('change', e=>{
  buatInputWarna(parseInt(e.target.value));
});

function formatOhm(val){
  if(val>=1e6) return (val/1e6).toFixed(2)+" MŒ©";
  if(val>=1e3) return (val/1e3).toFixed(2)+" kŒ©";
  return val+" Œ©";
}

function hitungResistorWarna(){
  const jumlah=parseInt(document.getElementById('gelangCount').value);
  let gelang=[];
  for(let i=1;i<=jumlah;i++){
    gelang.push(document.getElementById('gelang'+i).value);
  }
  let nilai=0; let tol="";
  if(jumlah===4){
    const d1=warnaMap[gelang[0]].val;
    const d2=warnaMap[gelang[1]].val;
    const mult=warnaMap[gelang[2]].mult;
    tol=warnaMap[gelang[3]].tol;
    nilai=(d1*10+d2)*mult;
  }
  if(jumlah===5){
    const d1=warnaMap[gelang[0]].val;
    const d2=warnaMap[gelang[1]].val;
    const d3=warnaMap[gelang[2]].val;
    const mult=warnaMap[gelang[3]].mult;
    tol=warnaMap[gelang[4]].tol;
    nilai=(d1*100+d2*10+d3)*mult;
  }
  if(jumlah===6){
    const d1=warnaMap[gelang[0]].val;
    const d2=warnaMap[gelang[1]].val;
    const d3=warnaMap[gelang[2]].val;
    const mult=warnaMap[gelang[3]].mult;
    tol=warnaMap[gelang[4]].tol;
    nilai=(d1*100+d2*10+d3)*mult;
  }
  document.getElementById('hasilWarna').innerText="Nilai: "+formatOhm(nilai)+ (tol?" ¬±"+tol+"%":"");
}

function hitungResistorSMD(){
  let kode=document.getElementById('kodeSMD').value.trim().toUpperCase();
  let nilai=null;
  if(kode.includes('R')){
    nilai=parseFloat(kode.replace('R','.'));
  }else if(kode.length===3){
    let d1=parseInt(kode[0]);
    let d2=parseInt(kode[1]);
    let mult=Math.pow(10,parseInt(kode[2]));
    nilai=(d1*10+d2)*mult;
  }else if(kode.length===4){
    let d1=parseInt(kode[0]);
    let d2=parseInt(kode[1]);
    let d3=parseInt(kode[2]);
    let mult=Math.pow(10,parseInt(kode[3]));
    nilai=(d1*100+d2*10+d3)*mult;
  }
  if(nilai!==null){
    document.getElementById('hasilSMD').innerText="Nilai: "+formatOhm(nilai);
  }else{
    document.getElementById('hasilSMD').innerText="Kode tidak valid";
  }
}
      if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker registered"))
        .catch(err => console.error("SW registration failed:", err));
    }
</script>
</body>
</html>
